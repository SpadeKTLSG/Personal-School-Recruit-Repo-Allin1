‍

‍

# 概念

‍

## 零碎

‍

### linux的常用命令

find 、rm、rmdir、mv、cp、cat、pwd、chmod、kill、ping、ifconfig

tail、ps、grep、netstat、echo、ssh、scp、top、mpstat、free、df

‍

* man, 查看文档
* lsof -i :{port}  查看占用某个端口的进程
* find ./ -name filename    搜索当前目录下某个名字的文件
* wc [选项] 文件1 文件2  
    -c 统计字节数  
    -l 统计行数  
    -w 统计字数

  统计文件行数
* ‍

‍

‍

‍

‍

‍

### 从linux命令和日志层面分析问题

发现业务问题后，首先到linux里用vi命令打开日志，然后用关键字去搜索，根据时间定位到日志后，再根据traceid或线程号找到错误日志的上下文

> 找到业务问题后，别展开讲，因为面试官不关心业务，而可以直接说，解决了空指针等问题.

‍

‍

### Linux cpu或内存OOM问题

一般说辞是，用linux命令排序看下当下哪个线程CPU或内存用量过高，必要时再看下dump文件，用jstack或jmap命令分析一下

这块更可以参考别人的问题排查经验，比如下文给出了一次排查内存问题的经验，其中是因为用到的对象没关掉. 那你也可以结合业务说，比如你是做支付的，支付后连接网银的对象没关，所以导致了OOM.

‍

### 在linux里面有两个进程，一个进行在修改这个文件，另外一个去删除这个文件，会发生什么？

在 Linux 中，如果一个进程正在修改一个文件，而另一个进程删除了这个文件，会发生以下情况：

1. **文件描述符**：正在修改文件的进程持有该文件的文件描述符。即使文件被删除，文件描述符仍然有效，进程可以继续修改文件。
2. **文件删除**：文件被删除后，文件名从文件系统中移除，但文件数据仍然存在，直到所有引用该文件的文件描述符关闭为止。
3. **数据一致性**：正在修改文件的进程可以继续对文件进行读写操作，直到它关闭文件描述符。此时，文件数据才会真正从磁盘上删除。

总结：文件被删除后，正在修改文件的进程不会立即受到影响，可以继续操作文件，直到关闭文件描述符。文件数据在所有文件描述符关闭后才会被真正删除。

‍

### 如果多用户场景下cpu存在瓶颈，执行不过来，如何定位在哪一个环节？

1. **使用** **​`top`​**​ **或** **​`htop`​**​ **命令**：查看系统中 CPU 使用率较高的进程。
2. **使用** **​`pidstat`​**​ **命令**：查看各个进程的 CPU 使用情况。
3. **使用** **​`perf`​**​ **工具**：分析具体的函数调用和 CPU 使用情况。
4. **使用** **​`strace`​**​ **工具**：跟踪系统调用，查看是否有大量的系统调用导致 CPU 瓶颈。
5. **分析应用日志**：查看应用日志，定位是否有特定的操作或请求导致 CPU 使用率飙升。
6. **使用 Java Profiling 工具**：如 VisualVM、YourKit 或 JProfiler，分析 Java 应用的 CPU 使用情况。

以下是一些常用命令的示例：

```sh
# 查看系统中 CPU 使用率较高的进程
top

# 查看各个进程的 CPU 使用情况
pidstat -u 1

# 使用 perf 工具分析具体的函数调用和 CPU 使用情况
perf top

# 跟踪系统调用
strace -p <pid>

# 使用 VisualVM 分析 Java 应用的 CPU 使用情况
jvisualvm
```

通过这些工具和方法，可以逐步定位到具体的瓶颈环节，从而进行优化。

‍

‍

## 硬链接和软链接的区别?

在 Linux 中，硬链接和软链接（符号链接）是两种不同的文件链接方式，它们有以下区别：

* **硬链接**：共享相同的 inode 号，不能跨文件系统，不能对目录创建。
* **软链接**：有自己的 inode 号，存储路径信息，可以跨文件系统，可以对目录创建。

‍

### 硬链接 (Hard Link)

* **定义**：硬链接是指向同一文件数据块的多个文件名。
* **特点**：

  * 硬链接共享相同的 inode 号。
  * 删除一个硬链接不会影响其他硬链接，只有当所有硬链接都被删除时，文件数据才会被删除。
  * 不能跨文件系统创建硬链接。
  * 不能对目录创建硬链接。
* **创建**：使用 `ln`​ 命令。

  ```sh
  ln source_file hard_link
  ```

‍

‍

### 软链接 (Symbolic Link)

* **定义**：软链接是一个指向另一个文件或目录的路径名。
* **特点**：

  * 软链接有自己的 inode 号和数据块，数据块中存储的是目标文件的路径。
  * 删除软链接不会影响目标文件，但如果目标文件被删除，软链接会变成**无效链接**（悬挂链接）。
  * 可以跨文件系统创建软链接。
  * 可以对目录创建软链接。
* **创建**：使用 `ln -s`​ 命令。

  ```sh
  ln -s target_file symbolic_link
  ```

‍

‍

## inode是什么

inode（索引节点）是一个数据结构，用于存储文件的**元数据**。

每个文件和目录都有一个唯一的 inode，包含以下信息：

* 文件类型（如普通文件、目录、符号链接等）
* 文件权限（读、写、执行权限）
* 文件所有者和所属组
* 文件大小
* 文件的时间戳（创建时间、修改时间、访问时间）
* 链接计数（指向该文件的硬链接数量）
* 数据块指针（指向文件数据所在的磁盘块）

‍

inode 不包含文件名。文件名和 inode 之间的映射关系存储在目录项中。

可以使用 `ls -i`​ 命令查看文件的 inode 号：

```sh
ls -i filename
```

例如：

```sh
$ ls -i /etc/passwd
123456 /etc/passwd
```

这将显示 `/etc/passwd`​ 文件的 inode 号为 123456。

‍

‍

‍

### 在Linux下怎么查看Java线程吗？

在 Linux 下查看 Java 线程可以使用 `jstack`​ 工具。`jstack`​ 是 JDK 提供的一个工具，用于生成 Java 虚拟机中线程的堆栈跟踪。以下是使用 `jstack`​ 查看 Java 线程的步骤：

1. **找到 Java 进程的 PID**：  
    使用 `jps`​ 或 `ps`​ 命令找到正在运行的 Java 进程的 PID（进程 ID）。

    ```sh
    jps -l
    ```

    或者

    ```sh
    ps -ef | grep java
    ```
2. **使用** **​`jstack`​**​ **查看线程堆栈**：  
    使用 `jstack`​ 命令并传入找到的 PID 来查看线程堆栈。

    ```sh
    jstack <pid>
    ```

    例如，如果 Java 进程的 PID 是 12345，则命令如下：

    ```sh
    jstack 12345
    ```
3. **分析输出**：  
    ​`jstack`​ 的输出将显示所有线程的堆栈跟踪信息，可以用来分析线程的状态和活动。

‍

示例：

```sh
$ jps -l
12345 com.example.MyApplication

$ jstack 12345
```

这将输出 Java 进程 12345 的所有线程堆栈信息。

‍

# 大块

‍

‍

# 高级

‍

‍
