‍

‍

# 概念

‍

‍

## 零碎

‍

‍

‍

‍

# 大块

‍

## Nginx - 代理

‍

### 反向代理和正向代理的区别, 以及为什么要做反向代理

正向代理和反向代理是代理服务器的两种主要类型，它们在功能和应用场景上有所不同

‍

‍

#### 正向代理

正向代理是客户端用来访问互联网的代理服务器。它位于客户端和目标服务器之间，**代表客户端向目标服务器发送请求**，并将目标服务器的响应返回给客户端。正向代理的主要用途包括：

* **访问控制**：允许或阻止对特定网站的访问。
* **缓存**：缓存常用资源以提高访问速度。
* **匿名访问**：隐藏客户端的真实IP地址。

‍

#### 反向代理

反向代理是服务器端用来处理客户端请求的代理服务器。它位于客户端和目标服务器之间，代表目标服务器接收客户端请求，并将请求转发给内部服务器处理，然后将响应返回给客户端。反向代理的主要用途包括：

* **负载均衡**：将请求分发到多台服务器以==均衡负载==。
* **安全性**：隐藏内部服务器的==真实IP地址==，防止直接访问。
* **缓存**：缓存静态内容以减少服务器负载和提高响应速度。
* **SSL终止**：处理SSL加密以减轻内部服务器的负担。

通过使用反向代理，可以提高系统的性能、安全性和可扩展性，是现代网络架构中不可或缺的一部分。

‍

**nginx 反向代理的好处：**

* 提高访问速度因为nginx本身可以进行缓存，如果访问的同一接口，并且做了数据缓存，nginx就直接可把数据返回，不需要真正地访问服务端，从而提高访问速度。
* 进行负载均衡所谓负载均衡,就是把大量的请求按照我们指定的方式均衡的分配给集群中的每台服务器。
* 保证后端服务安全因为一般后台服务地址不会暴露，所以使用浏览器不能直接访问，可以把nginx作为请求访问的入口，请求到达nginx后转发到具体的服务中，从而保证后端服务的安全。

‍

## Nginx - 负载均衡

当如果服务以集群的方式进行部署时，那nginx在转发请求到服务器时就需要做相应的负载均衡。其实，负载均衡从本质上来说也是基于反向代理来实现的，最终都是转发请求。

在nginx的配置文件设置负载均衡策略。

nginx有很多负载均衡策略，比如轮询，weight权重方式,url分配方式，我们项目用的是轮询方式，共有3台后端服务器

‍

**策略**

|轮询|默认方式，每个请求会按时间顺序逐一分配到不同的后端服务器。|
| ----------------| ------------------------------------------------------------|
|weight|权重方式，默认为1，权重越高，被分配的客户端请求就越多|
|ip\_hash|依据ip分配方式，这样每个访客可以固定访问一个后端服务|
|least\_conn|依据最少连接方式，把请求优先分配给连接数少的后端服务|
|url\_hash|依据url分配方式，这样相同的url会被分配到同一个后端服务|
|fair|依据响应时间方式，响应时间短的服务将会被优先分配|

‍

‍

‍

‍

‍

‍

# 高级

‍
